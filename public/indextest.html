<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<style type="text/css">
.ui-helper-hidden{display:none;}.ui-helper-hidden-accessible{position:absolute;left:-99999999px;}.ui-helper-reset{margin:0;padding:0;border:0;outline:0;line-height:1.3;text-decoration:none;font-size:100%;list-style:none;}.ui-helper-clearfix:after{content:".";display:block;height:0;clear:both;visibility:hidden;}.ui-helper-clearfix{display:inline-block;}/* required comment for clearfix to work in Opera \*/ * html .ui-helper-clearfix{height:1%;}.ui-helper-clearfix{display:block;}/* end clearfix */ .ui-helper-zfix{width:100%;height:100%;top:0;left:0;position:absolute;opacity:0;filter:Alpha(Opacity=0);}.ui-state-disabled{cursor:default!important;}.ui-icon{display:block;text-indent:-99999px;overflow:hidden;background-repeat:no-repeat;}.ui-widget-overlay{position:absolute;top:0;left:0;width:100%;height:100%;}.ui-widget{font-family:Arial,sans-serif;font-size:1.3em;}.ui-widget .ui-widget{font-size:1em;}.ui-widget input,.ui-widget select,.ui-widget textarea,.ui-widget button{font-family:Arial,sans-serif;font-size:1em;}.ui-widget-content{border:1px solid #000;background:#111 url(images/ui-bg_gloss-wave_20_111111_500x100.png) 50% top repeat-x;color:#d9d9d9;}.ui-widget-content a{color:#d9d9d9;}.ui-widget-header{border:1px solid #0b3e6f;background:#0b3e6f url(images/ui-bg_diagonals-thick_15_0b3e6f_40x40.png) 50% 50% repeat;color:#f6f6f6;font-weight:bold;}.ui-widget-header a{color:#f6f6f6;}.ui-state-default,.ui-widget-content .ui-state-default{border:1px solid #333;background:#333 url(images/ui-bg_dots-small_20_333333_2x2.png) 50% 50% repeat;font-weight:bold;color:#fff;}.ui-state-default a,.ui-state-default a:link,.ui-state-default a:visited{color:#fff;text-decoration:none;}.ui-state-hover,.ui-widget-content .ui-state-hover,.ui-state-focus,.ui-widget-content .ui-state-focus{border:1px solid #222;background:#00498f url(images/ui-bg_dots-small_40_00498f_2x2.png) 50% 50% repeat;font-weight:bold;color:#fff;}.ui-state-hover a,.ui-state-hover a:hover{color:#fff;text-decoration:none;}.ui-state-active,.ui-widget-content .ui-state-active{border:1px solid #096ac8;background:#292929 url(images/ui-bg_flat_40_292929_40x100.png) 50% 50% repeat-x;font-weight:bold;color:#75abff;}.ui-state-active a,.ui-state-active a:link,.ui-state-active a:visited{color:#75abff;text-decoration:none;}.ui-widget :active{outline:none;}.ui-state-highlight,.ui-widget-content .ui-state-highlight{border:1px solid #052f57;background:#0b58a2 url(images/ui-bg_dots-medium_30_0b58a2_4x4.png) 50% 50% repeat;color:#fff;}.ui-state-highlight a,.ui-widget-content .ui-state-highlight a{color:#fff;}.ui-state-error,.ui-widget-content .ui-state-error{border:1px solid #cd0a0a;background:#a32d00 url(images/ui-bg_dots-small_30_a32d00_2x2.png) 50% 50% repeat;color:#fff;}.ui-state-error a,.ui-widget-content .ui-state-error a{color:#fff;}.ui-state-error-text,.ui-widget-content .ui-state-error-text{color:#fff;}.ui-priority-primary,.ui-widget-content .ui-priority-primary{font-weight:bold;}.ui-priority-secondary,.ui-widget-content .ui-priority-secondary{opacity:.7;filter:Alpha(Opacity=70);font-weight:normal;}.ui-state-disabled,.ui-widget-content .ui-state-disabled{opacity:.35;filter:Alpha(Opacity=35);background-image:none;}.ui-icon{width:16px;height:16px;background-image:url(images/ui-icons_9ccdfc_256x240.png);}.ui-widget-content .ui-icon{background-image:url(images/ui-icons_9ccdfc_256x240.png);}.ui-widget-header .ui-icon{background-image:url(images/ui-icons_98d2fb_256x240.png);}.ui-state-default .ui-icon{background-image:url(images/ui-icons_9ccdfc_256x240.png);}.ui-state-hover .ui-icon,.ui-state-focus .ui-icon{background-image:url(images/ui-icons_ffffff_256x240.png);}.ui-state-active .ui-icon{background-image:url(images/ui-icons_00498f_256x240.png);}.ui-state-highlight .ui-icon{background-image:url(images/ui-icons_ffffff_256x240.png);}.ui-state-error .ui-icon,.ui-state-error-text .ui-icon{background-image:url(images/ui-icons_ffffff_256x240.png);}.ui-icon-carat-1-n{background-position:0 0;}.ui-icon-carat-1-ne{background-position:-16px 0;}.ui-icon-carat-1-e{background-position:-32px 0;}.ui-icon-carat-1-se{background-position:-48px 0;}.ui-icon-carat-1-s{background-position:-64px 0;}.ui-icon-carat-1-sw{background-position:-80px 0;}.ui-icon-carat-1-w{background-position:-96px 0;}.ui-icon-carat-1-nw{background-position:-112px 0;}.ui-icon-carat-2-n-s{background-position:-128px 0;}.ui-icon-carat-2-e-w{background-position:-144px 0;}.ui-icon-triangle-1-n{background-position:0 -16px;}.ui-icon-triangle-1-ne{background-position:-16px -16px;}.ui-icon-triangle-1-e{background-position:-32px -16px;}.ui-icon-triangle-1-se{background-position:-48px -16px;}.ui-icon-triangle-1-s{background-position:-64px -16px;}.ui-icon-triangle-1-sw{background-position:-80px -16px;}.ui-icon-triangle-1-w{background-position:-96px -16px;}.ui-icon-triangle-1-nw{background-position:-112px -16px;}.ui-icon-triangle-2-n-s{background-position:-128px -16px;}.ui-icon-triangle-2-e-w{background-position:-144px -16px;}.ui-icon-arrow-1-n{background-position:0 -32px;}.ui-icon-arrow-1-ne{background-position:-16px -32px;}.ui-icon-arrow-1-e{background-position:-32px -32px;}.ui-icon-arrow-1-se{background-position:-48px -32px;}.ui-icon-arrow-1-s{background-position:-64px -32px;}.ui-icon-arrow-1-sw{background-position:-80px -32px;}.ui-icon-arrow-1-w{background-position:-96px -32px;}.ui-icon-arrow-1-nw{background-position:-112px -32px;}.ui-icon-arrow-2-n-s{background-position:-128px -32px;}.ui-icon-arrow-2-ne-sw{background-position:-144px -32px;}.ui-icon-arrow-2-e-w{background-position:-160px -32px;}.ui-icon-arrow-2-se-nw{background-position:-176px -32px;}.ui-icon-arrowstop-1-n{background-position:-192px -32px;}.ui-icon-arrowstop-1-e{background-position:-208px -32px;}.ui-icon-arrowstop-1-s{background-position:-224px -32px;}.ui-icon-arrowstop-1-w{background-position:-240px -32px;}.ui-icon-arrowthick-1-n{background-position:0 -48px;}.ui-icon-arrowthick-1-ne{background-position:-16px -48px;}.ui-icon-arrowthick-1-e{background-position:-32px -48px;}.ui-icon-arrowthick-1-se{background-position:-48px -48px;}.ui-icon-arrowthick-1-s{background-position:-64px -48px;}.ui-icon-arrowthick-1-sw{background-position:-80px -48px;}.ui-icon-arrowthick-1-w{background-position:-96px -48px;}.ui-icon-arrowthick-1-nw{background-position:-112px -48px;}.ui-icon-arrowthick-2-n-s{background-position:-128px -48px;}.ui-icon-arrowthick-2-ne-sw{background-position:-144px -48px;}.ui-icon-arrowthick-2-e-w{background-position:-160px -48px;}.ui-icon-arrowthick-2-se-nw{background-position:-176px -48px;}.ui-icon-arrowthickstop-1-n{background-position:-192px -48px;}.ui-icon-arrowthickstop-1-e{background-position:-208px -48px;}.ui-icon-arrowthickstop-1-s{background-position:-224px -48px;}.ui-icon-arrowthickstop-1-w{background-position:-240px -48px;}.ui-icon-arrowreturnthick-1-w{background-position:0 -64px;}.ui-icon-arrowreturnthick-1-n{background-position:-16px -64px;}.ui-icon-arrowreturnthick-1-e{background-position:-32px -64px;}.ui-icon-arrowreturnthick-1-s{background-position:-48px -64px;}.ui-icon-arrowreturn-1-w{background-position:-64px -64px;}.ui-icon-arrowreturn-1-n{background-position:-80px -64px;}.ui-icon-arrowreturn-1-e{background-position:-96px -64px;}.ui-icon-arrowreturn-1-s{background-position:-112px -64px;}.ui-icon-arrowrefresh-1-w{background-position:-128px -64px;}.ui-icon-arrowrefresh-1-n{background-position:-144px -64px;}.ui-icon-arrowrefresh-1-e{background-position:-160px -64px;}.ui-icon-arrowrefresh-1-s{background-position:-176px -64px;}.ui-icon-arrow-4{background-position:0 -80px;}.ui-icon-arrow-4-diag{background-position:-16px -80px;}.ui-icon-extlink{background-position:-32px -80px;}.ui-icon-newwin{background-position:-48px -80px;}.ui-icon-refresh{background-position:-64px -80px;}.ui-icon-shuffle{background-position:-80px -80px;}.ui-icon-transfer-e-w{background-position:-96px -80px;}.ui-icon-transferthick-e-w{background-position:-112px -80px;}.ui-icon-folder-collapsed{background-position:0 -96px;}.ui-icon-folder-open{background-position:-16px -96px;}.ui-icon-document{background-position:-32px -96px;}.ui-icon-document-b{background-position:-48px -96px;}.ui-icon-note{background-position:-64px -96px;}.ui-icon-mail-closed{background-position:-80px -96px;}.ui-icon-mail-open{background-position:-96px -96px;}.ui-icon-suitcase{background-position:-112px -96px;}.ui-icon-comment{background-position:-128px -96px;}.ui-icon-person{background-position:-144px -96px;}.ui-icon-print{background-position:-160px -96px;}.ui-icon-trash{background-position:-176px -96px;}.ui-icon-locked{background-position:-192px -96px;}.ui-icon-unlocked{background-position:-208px -96px;}.ui-icon-bookmark{background-position:-224px -96px;}.ui-icon-tag{background-position:-240px -96px;}.ui-icon-home{background-position:0 -112px;}.ui-icon-flag{background-position:-16px -112px;}.ui-icon-calendar{background-position:-32px -112px;}.ui-icon-cart{background-position:-48px -112px;}.ui-icon-pencil{background-position:-64px -112px;}.ui-icon-clock{background-position:-80px -112px;}.ui-icon-disk{background-position:-96px -112px;}.ui-icon-calculator{background-position:-112px -112px;}.ui-icon-zoomin{background-position:-128px -112px;}.ui-icon-zoomout{background-position:-144px -112px;}.ui-icon-search{background-position:-160px -112px;}.ui-icon-wrench{background-position:-176px -112px;}.ui-icon-gear{background-position:-192px -112px;}.ui-icon-heart{background-position:-208px -112px;}.ui-icon-star{background-position:-224px -112px;}.ui-icon-link{background-position:-240px -112px;}.ui-icon-cancel{background-position:0 -128px;}.ui-icon-plus{background-position:-16px -128px;}.ui-icon-plusthick{background-position:-32px -128px;}.ui-icon-minus{background-position:-48px -128px;}.ui-icon-minusthick{background-position:-64px -128px;}.ui-icon-close{background-position:-80px -128px;}.ui-icon-closethick{background-position:-96px -128px;}.ui-icon-key{background-position:-112px -128px;}.ui-icon-lightbulb{background-position:-128px -128px;}.ui-icon-scissors{background-position:-144px -128px;}.ui-icon-clipboard{background-position:-160px -128px;}.ui-icon-copy{background-position:-176px -128px;}.ui-icon-contact{background-position:-192px -128px;}.ui-icon-image{background-position:-208px -128px;}.ui-icon-video{background-position:-224px -128px;}.ui-icon-script{background-position:-240px -128px;}.ui-icon-alert{background-position:0 -144px;}.ui-icon-info{background-position:-16px -144px;}.ui-icon-notice{background-position:-32px -144px;}.ui-icon-help{background-position:-48px -144px;}.ui-icon-check{background-position:-64px -144px;}.ui-icon-bullet{background-position:-80px -144px;}.ui-icon-radio-off{background-position:-96px -144px;}.ui-icon-radio-on{background-position:-112px -144px;}.ui-icon-pin-w{background-position:-128px -144px;}.ui-icon-pin-s{background-position:-144px -144px;}.ui-icon-play{background-position:0 -160px;}.ui-icon-pause{background-position:-16px -160px;}.ui-icon-seek-next{background-position:-32px -160px;}.ui-icon-seek-prev{background-position:-48px -160px;}.ui-icon-seek-end{background-position:-64px -160px;}.ui-icon-seek-start{background-position:-80px -160px;}.ui-icon-seek-first{background-position:-80px -160px;}.ui-icon-stop{background-position:-96px -160px;}.ui-icon-eject{background-position:-112px -160px;}.ui-icon-volume-off{background-position:-128px -160px;}.ui-icon-volume-on{background-position:-144px -160px;}.ui-icon-power{background-position:0 -176px;}.ui-icon-signal-diag{background-position:-16px -176px;}.ui-icon-signal{background-position:-32px -176px;}.ui-icon-battery-0{background-position:-48px -176px;}.ui-icon-battery-1{background-position:-64px -176px;}.ui-icon-battery-2{background-position:-80px -176px;}.ui-icon-battery-3{background-position:-96px -176px;}.ui-icon-circle-plus{background-position:0 -192px;}.ui-icon-circle-minus{background-position:-16px -192px;}.ui-icon-circle-close{background-position:-32px -192px;}.ui-icon-circle-triangle-e{background-position:-48px -192px;}.ui-icon-circle-triangle-s{background-position:-64px -192px;}.ui-icon-circle-triangle-w{background-position:-80px -192px;}.ui-icon-circle-triangle-n{background-position:-96px -192px;}.ui-icon-circle-arrow-e{background-position:-112px -192px;}.ui-icon-circle-arrow-s{background-position:-128px -192px;}.ui-icon-circle-arrow-w{background-position:-144px -192px;}.ui-icon-circle-arrow-n{background-position:-160px -192px;}.ui-icon-circle-zoomin{background-position:-176px -192px;}.ui-icon-circle-zoomout{background-position:-192px -192px;}.ui-icon-circle-check{background-position:-208px -192px;}.ui-icon-circlesmall-plus{background-position:0 -208px;}.ui-icon-circlesmall-minus{background-position:-16px -208px;}.ui-icon-circlesmall-close{background-position:-32px -208px;}.ui-icon-squaresmall-plus{background-position:-48px -208px;}.ui-icon-squaresmall-minus{background-position:-64px -208px;}.ui-icon-squaresmall-close{background-position:-80px -208px;}.ui-icon-grip-dotted-vertical{background-position:0 -224px;}.ui-icon-grip-dotted-horizontal{background-position:-16px -224px;}.ui-icon-grip-solid-vertical{background-position:-32px -224px;}.ui-icon-grip-solid-horizontal{background-position:-48px -224px;}.ui-icon-gripsmall-diagonal-se{background-position:-64px -224px;}.ui-icon-grip-diagonal-se{background-position:-80px -224px;}.ui-corner-tl{-moz-border-radius-topleft:4px;-webkit-border-top-left-radius:4px;border-top-left-radius:4px;}.ui-corner-tr{-moz-border-radius-topright:4px;-webkit-border-top-right-radius:4px;border-top-right-radius:4px;}.ui-corner-bl{-moz-border-radius-bottomleft:4px;-webkit-border-bottom-left-radius:4px;border-bottom-left-radius:4px;}.ui-corner-br{-moz-border-radius-bottomright:4px;-webkit-border-bottom-right-radius:4px;border-bottom-right-radius:4px;}.ui-corner-top{-moz-border-radius-topleft:4px;-webkit-border-top-left-radius:4px;border-top-left-radius:4px;-moz-border-radius-topright:4px;-webkit-border-top-right-radius:4px;border-top-right-radius:4px;}.ui-corner-bottom{-moz-border-radius-bottomleft:4px;-webkit-border-bottom-left-radius:4px;border-bottom-left-radius:4px;-moz-border-radius-bottomright:4px;-webkit-border-bottom-right-radius:4px;border-bottom-right-radius:4px;}.ui-corner-right{-moz-border-radius-topright:4px;-webkit-border-top-right-radius:4px;border-top-right-radius:4px;-moz-border-radius-bottomright:4px;-webkit-border-bottom-right-radius:4px;border-bottom-right-radius:4px;}.ui-corner-left{-moz-border-radius-topleft:4px;-webkit-border-top-left-radius:4px;border-top-left-radius:4px;-moz-border-radius-bottomleft:4px;-webkit-border-bottom-left-radius:4px;border-bottom-left-radius:4px;}.ui-corner-all{-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;}.ui-widget-overlay{background:#aaa url(images/ui-bg_flat_0_aaaaaa_40x100.png) 50% 50% repeat-x;opacity:.30;filter:Alpha(Opacity=30);}.ui-widget-shadow{margin:-8px 0 0 -8px;padding:8px;background:#aaa url(images/ui-bg_flat_0_aaaaaa_40x100.png) 50% 50% repeat-x;opacity:.30;filter:Alpha(Opacity=30);-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px;}.ui-button{display:inline-block;position:relative;padding:0;margin-right:.1em;text-decoration:none!important;cursor:pointer;text-align:center;zoom:1;overflow:visible;}.ui-button-icon-only{width:2.2em;}button.ui-button-icon-only{width:2.4em;}.ui-button-icons-only{width:3.4em;}button.ui-button-icons-only{width:3.7em;}.ui-button .ui-button-text{display:block;line-height:1.4;}.ui-button-text-only .ui-button-text{padding:.4em 1em;}.ui-button-icon-only .ui-button-text,.ui-button-icons-only .ui-button-text{padding:.4em;text-indent:-9999999px;}.ui-button-text-icon .ui-button-text,.ui-button-text-icons .ui-button-text{padding:.4em 1em .4em 2.1em;}.ui-button-text-icons .ui-button-text{padding-left:2.1em;padding-right:2.1em;}input.ui-button{padding:.4em 1em;}.ui-button-icon-only .ui-icon,.ui-button-text-icon .ui-icon,.ui-button-text-icons .ui-icon,.ui-button-icons-only .ui-icon{position:absolute;top:50%;margin-top:-8px;}.ui-button-icon-only .ui-icon{left:50%;margin-left:-8px;}.ui-button-text-icon .ui-button-icon-primary,.ui-button-text-icons .ui-button-icon-primary,.ui-button-icons-only .ui-button-icon-primary{left:.5em;}.ui-button-text-icons .ui-button-icon-secondary,.ui-button-icons-only .ui-button-icon-secondary{right:.5em;}.ui-buttonset{margin-right:7px;}.ui-buttonset .ui-button{margin-left:0;margin-right:-.3em;}button.ui-button::-moz-focus-inner{border:0;padding:0;}
</style>
<style type="text/css">
html {
	font-family: Helvetica, helvetica, Arial, arial, sans-serif;
        height: 100%;
	width: 100%;
	margin: 0px;
	padding: 0px;
}

body {
	display: block;
	width: 100%;
	color: white;
	margin: 0px;
	padding: 0px;
        height: 98%;
	min-height: 420px;
	background-color: black;
	
	
}
.hidden {
   	position: absolute;
	left: -10000px;
}
#map_holder {
	max-width: 500px !important;
	position: relative;
        background-color: black;
   	height: inherit;
   	width: inherit;
	margin: 0px;
	padding: 0px;
	
}
#map_canvas {
   	
	background-color: black;
   	height:inherit;
	width: inherit;
	margin: 0px;
	padding: 0px;
}

#main_page {
	max-width: 500px !important;
	position: absolute;
	height: inherit;
	text-align: center;
	vertical-align: middle;
	color: white;
   	width: inherit;
	margin-left: 0px;
	padding: 0px;	
}
#stop_times {
	max-width: 500px;
	vertical-align: middle;
}

.titlebar {
	background-image: url('toolbar.png');
	background-repeat: repeat-x;
	text-align: center;
	font-family: Helvetica, helvetica, Arial, arial, sans-serif;
	font-size: 20px;
	font-weight: bold;
	text-shadow: rgba(0, 0, 0, 0.4) 0px -1px 0;
	width: 100%;
	padding-top: 15px;
	padding-bottom: 15px;
	
}
.title {
	margin-top:10px;
}
.page {
	margin-top: 30px;
	background-color: black;
	color: white;
}

button.fullscreen {
	width: 100%;
	height: 40px;
}

#backtomain {
	height:45px;
}
table#buses {
	padding-left: 2px;
	border-width: 2px;
	border-spacing: 2px;
	border-style: none;
	
}
table th {
	font-size: large;
	text-align: center;
	border-width: 0px;
	padding: 3px;
	border-style: none;
	
}
table td {
	text-align: center;
	border-width: 0px;
	padding: 5px;
	border-style: none;
}
#stop_times h2 {
	text-align: center;
}
.ui-icon-play{
	z-index: -1000;
}
#address {
	width: 250px;
	font-size: large;
}

</style>   
<title>myTranspo</title>
<meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" name="viewport"/>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<!-- <link type="text/css" href="css/dot-luv/jquery-ui-1.8.custom.css" rel="Stylesheet" /> -->
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">google.load("jquery", "1.4.2");</script>
<script type="text/javascript" src="./js/jquery-ui-1.8.custom.min.js"></script>
<!--<script type ="text/javascript" src="mytranspo.min.js"></script>-->
<script type ="text/javascript">
Map={latitude:45.423415,longitude:-75.698379,map:" ",markersArray:[],Boundaries:{swLat:0,swLng:0,neLat:0,neLng:0},init:function(location){if(navigator.geolocation){Map.latitude=location.coords.latitude;Map.longitude=location.coords.longitude;}},createmap:function(){latlng=new google.maps.LatLng(this.latitude,this.longitude);var mapOptions={zoom:17,center:latlng,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:true,navigationControl:true,navigationControlOptions:{style:google.maps.NavigationControlStyle.ANDROID},mapTypeControl:false};map=new google.maps.Map(document.getElementById('map_canvas'),mapOptions);google.maps.event.addListener(map,'tilesloaded',function(){Map.redoBoundaries();Map.addpoints();google.maps.event.clearListeners(map,'tilesloaded');});google.maps.event.addListener(map,'dragend',function(){if(map.zoom<16){return;}Map.redoBoundaries();Map.addpoints();});google.maps.event.addListener(map,'zoom_changed',function(){if(map.zoom<16){alert("Stops not available at this zoom level. Please zoom in to load more stops.");return;}setTimeout(function(){Map.redoBoundaries();Map.addpoints();},100);});},addpoints:function(){$.get("/points/"+Map.Boundaries.swLat+"/"+Map.Boundaries.neLat+"/"+Map.Boundaries.swLng+"/"+Map.Boundaries.neLng,function(response){var result=eval(response);for(var key in result){var stopLatLng=new google.maps.LatLng(result[key]["stop"]["stop_lat"]-.00001,result[key]["stop"]["stop_lon"]+.0000455);var marker=new google.maps.Marker({position:stopLatLng,map:map,title:result[key]["stop"]["stop_name"],icon:'bus.png'});var id=result[key]["stop"]["stop_id"];google.maps.event.addListener(marker,'click',Map.handleMarkerClick(id));Map.markersArray.unshift(marker);if(Map.markersArray.length>20){var deleteme=Map.markersArray.pop();deleteme.setMap(null);}}});},changeBoundaries:function(newMinLat,newMaxLat,newMinLon,newMaxLon){this.minLat=newMinLat;this.maxLat=newMaxLat;this.minLon=newMinLon;this.maxLon=newMaxLon;},redoBoundaries:function(){this.Boundaries.swLat=map.getBounds().getSouthWest().lat();this.Boundaries.swLng=map.getBounds().getSouthWest().lng();this.Boundaries.neLat=map.getBounds().getNorthEast().lat();this.Boundaries.neLng=map.getBounds().getNorthEast().lng();},printBoundaries:function(){$("#map_canvas").html("SWLon: "+this.Boundaries.swLng+"<br />"+"SWLat: "+this.Boundaries.swLat+"<br />"+"NELon: "+this.Boundaries.neLng+"<br />"+"NELat: "+this.Boundaries.neLat+"<br />");},handleMarkerClick:function(stop_id){return function(){$.get("/stopinfo/"+stop_id,function(response){var nextbuses=eval(response);$("#buses").html("<tr><th colspan=1>Route</th><th>Destination</th><th colspan=1>Time</th></tr>");for(var key in nextbuses){var depTime=nextbuses[key]["departure_time"].replace(/:00$/,"");if(depTime.match(/^0[1-9]/)||depTime.match(/^1[0-1]/)){depTime+="AM";}else if(depTime.match(/^12/)){depTime+="PM";}else if(depTime.match(/^00/)){depTime.replace(/^00/,12);depTime+="AM";}else if(depTime.match(/^1[3-9]/)){var newTime=depTime.split(/:/);newTime[0]-=12;depTime=newTime[0]+':'+newTime[1]+'PM';}else{var newTime=depTime.split(/:/);newTime[0]-=12;depTime=newTime[0]+':'+newTime[1]+'PM';}$("#buses").append("<tr><td>"+nextbuses[key]["route_short_name"]+"</td><td>"+nextbuses[key]["trip_headsign"]+"</td><td>"+depTime+"</td></tr>");}$("#map_holder").addClass('hidden');$("#map_holder").css({height:0});$("#stop_times").removeClass('hidden');$("#stop_times").css({height:$('body').height()-45});$('#buses').css({marginLeft:($('#bus_info').width()-$('#buses').width())/2});});}},setLatLng:function(lat,lng){this.latitude=lat;this.longitude=lng;}}
$(function() {
		
		$("button.gotomap").button({icons: { primary: 'ui-icon-play',
						     secondary: 'ui-icon-circle-triangle-e' }});
		$("button.backtomain").button({icons: { primary: 'ui-icon-circle-triangle-w'}});
		
		$("button.backtomap").button({icons: { primary: 'ui-icon-circle-triangle-w'}});
		
		$("#gotomap").click(function() { $("#map_holder").removeClass('hidden');
						 $("#main_page").addClass('hidden');
						 setTimeout(scrollTo, 200, 0, 1);
                         $('#map_holder').css({ height : $('html').height()});
                         var mapHeight = $('body').height() - 45;
                         $('#map_canvas').css({ height: mapHeight});
                         Map.createmap();});
		
		$("#backtomain").click(function() { $("#main_page").removeClass('hidden');
						    $("#map_holder").addClass('hidden');
						    setTimeout(scrollTo, 100, 0, 1);});
		
		$("#backtomap").click(function() { $("#map_holder").removeClass('hidden');
						    $("#stop_times").addClass('hidden');
						    setTimeout(scrollTo, 100, 0, 1);});
	});

function init() {

    setTimeout(scrollTo, 100, 0, 1);
    $('body').css({ height : $('html').height() });
    
    if(navigator.geolocation) { 
    navigator.geolocation.getCurrentPosition(function(location) {
	    Map.setLatLng(localtion.coords.latitude, location.coords.longitude);
            $('#geo').append('Your device appears to support geolocation. Click \'Nearest Stops\'below to view the nearest bus stops stops. Click on \
			     any stop to view upcoming departures.');
    }, function() { $('#geo').append("<p>Your device appears to support geolocation, but your current location is unavailable. \
				   Please click \'Nearest Stops\' to use downtown Ottawa as a starting point. <br /><br />Click on any bus stop to see \
				   upcoming departures.</p>");   
	});       
    } else {
	$('#geo').append('<p>Your device does not appear to support geolocation. Please click \'Nearest Stops\' to use downtown Ottawa as a starting point. \
			<br /><br />Click on any bus stop to view upcoming departures.</p>');
    }
}
	
</script>
</head>
<body onload="init();">
        
	<div id="main_page">
		
		<div class="titlebar">myTranspo</div>
		<div class = "page">
		<div id = "geo"><p>Welcome to myTranspo!</p>
		</div>
		<button id="gotomap" class="fullscreen gotomap">Nearest Stops</button>
		<br />
		</div>
	</div>
	<div id="map_holder" class="hidden">
		<button id = "backtomain" class="fullscreen backtomain">Back to myTranspo</button>
	<div id="map_canvas"></div>
	</div>
	
	<div id="stop_times" class="hidden">
		<button id = "backtomap" class="fullscreen backtomap">Back to Map</button>
		<div id="bus_info">
            <h2>Upcoming Departures</h2><br />
        	<table id = 'buses'></table>
        </div>
	</div>
	
	
	<div id="stop_info"></div>
	<table id = 'newstops'></table>
</body>
<script type="text/javascript"> 
 
  var _gaq = _gaq || []; 
  _gaq.push(['_setAccount', 'UA-5655083-3']); 
  _gaq.push(['_trackPageview']); 
 
  (function() { 
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; 
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; 
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); 
  })(); 
</script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
</html>
